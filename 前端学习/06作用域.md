#  作用域

---

## 作用域的概念

> 作用域指一个变量的使用范围，在JS中，一共有两种作用域

- 全局作用域
- 函数作用域



## 全局作用域

> 直接编写在script标签中的JS代码，都在全局作用域

- 全局作用域在页面打开时创建，页面关闭时销毁
- 在全局作用域中有一个全局对象window，它代表的是一个浏览器窗口，它由浏览器创建我们可以直接使用



- 在全局作用域中
  - 创建的变量都会作为windows的对象的属性保存
  - 创建的函数都会作为windows的方法保存
- 全局作用域中的变量都是全局变量，在页面任意位置都可以访问得到



## 变量的声明提升

> 使用var关键词声明的变量`var a = 1`,会在所有的代码执行前被声明（但是不会赋值），但是如果声明变量时不是使用var关键词，比如直接写`a = 1`,则变量不会被声明提前

```javascript
console.log(a);
var a = 123;
```

- 变量提前，输出undefined，表示并未赋值

```javascript
console.log(a);
a = 123; //相当于window.a
```

- 程序报错



## 函数声明的提前

### 函数声明

> 使用函数声明的形式创建的函数` function(){}`，会被声明提前

- 也就是说，整个函数会在所有代码执行前就被创建，所以我们可以在函数声明之前，调用函数

```javascript
fn();

function fn(){
  console.log("fn1");
}
```

### 函数表达式

> 使用函数表达式创建的函数`var fn = function(){}`不会被声明提前，所以不能在声明前调用。很好理解，因为此时fn被声明了，而且为undefined，并没有把`function(){}`赋给fn

```javascript
fn2();

var fn2 = function fn(){
  console.log("fn1");
}
```

- 报错



## 作用域

- **作用域**：变量和函数的生效区域。作用域在**函数定义**时，就已经确定了

- 在函数作用域中可以访问到全局作用域的变量，在全局作用域中无法访问到函数作用域中的变量

- 执行期上下文：当函数执行时，会创建一个执行期上下文的内部对象，每次调用函数，就会创建一个新的上下文对象，他们直接时互相独立的。当函数执行完毕，他所产生的执行期上下文会被销毁

  - 当函数内部被另一个函数所引用，那么这个函数的变量将不会在执行完毕后销毁

    

- 作用域的上下级关系；
  - 当在函数作用域操作一个变量时，会在自身作用域寻找，如果有就直接使用，如果没有则向上一级作用域寻找，知道找到全局作用域。如果全局作用域没有，就会报错
  - 在函数中要访问全局变量可以使用window对象



- 提醒

  - 在函数作用域也有声明提前的特性：

    - 使用var关键字声明的变量，会在函数中所有的代码执行前被调用
    - 函数声明也会在函数中所有的代码执行前被执行

  - 因此，在函数中，没有var声明的变量都是全局变量，而且不会被提前声明

    ```javascript
    a = 1;//window.a = 1
    ```

    ```javascript
    var a = 1;
    
    function fn(){
      console.log(a);
      a = 2;
    }
    
    fn();
    console.log(a);
    ```

    

  - 定义了形式参数就相当于在函数作用域中声明了变量

  ```javascript
  function fn(e){
    //var e;
    console.log(e);
  }
  
  fn();//undefined
  fn(123);//123
  ```

  

